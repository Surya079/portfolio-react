import{r as n,F as R,K as k,h as T,j as s,U as N,i as w,T as m,a as C,P as S,Q as f,R as P,H as $,J as E,O as F,B as O}from"./index-DjCb9QRt.js";const I=({visible:a,email:c})=>{const[h,g]=n.useState(""),[x,t]=n.useState(30),[v,p]=n.useState(!1),[o,d]=n.useState(!0),{handleShowSnackbar:i}=R(),u=k(),b=T();n.useEffect(()=>{let e;return a&&(t(30),d(!0),e=setInterval(()=>{t(l=>l===1?(clearInterval(e),d(!1),0):l-1)},1e3)),()=>clearInterval(e)},[a]);const j=async()=>{try{p(!0);const e=await S.post(`https://portfolio-node-six.vercel.app${f.userVerifyOTP}`,{otp:h,email:c});e&&(p(!1),i(e.data.message,"success"),console.log(e.data.verifiedUser.username),u(P({isVerified:"verified"})),setTimeout(()=>{i("You have register successfull","success")},2e3),b("/blogs/login"))}catch(e){i(e.response.data.message,"error")}finally{p(!1)}},y=async()=>{console.log(`https://portfolio-node-six.vercel.app${f.userSendOtp}`);try{const e=await S.post(`https://portfolio-node-six.vercel.app${f.userSendOtp}`,{email:c});e&&(i(e.data.message,"success"),t(30),d(!0))}catch(e){i(e.response.data.message,"error")}};return s.jsx(N,{open:a,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{padding:20,backgroundColor:"white",borderRadius:8,boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",maxWidth:"400px",width:"100%"},children:[s.jsx(w,{variant:"h6",className:"text-center",gutterBottom:!0,children:"OTP Dialog"}),s.jsxs("span",{children:["OTP send to ************",c.slice(-10)," "]}),s.jsx(m,{fullWidth:!0,placeholder:"Enter OTP",value:h,onChange:e=>g(e.target.value),margin:"normal"}),s.jsx(C,{variant:"contained",className:"button",fullWidth:!0,onClick:j,sx:{marginTop:2},children:v?s.jsx("div",{className:"h-8 w-8 animate-spin  rounded-full border-4 border-e-transparent motion-reduce:animate-[spin_1.5s_linear_infinite]"}):"Verify"}),s.jsxs("div",{className:`flex justify-center mt-2 ${o?"cursor-not-allowed text-gray-400":"cursor-pointer text-green-700"}`,disabled:o,onClick:y,children:["Resend OTP ",o&&`(${x}s)`]})]})})},W=()=>{const[a,c]=n.useState({name:"",email:"",password:"",occupation:"",image:null}),h=T(),[g,x]=n.useState(!1),[t,v]=n.useState({}),[p,o]=n.useState(!1),{handleShowSnackbar:d}=R(),{isVerified:i}=$(E),u=e=>{const{name:l,value:r}=e.target;c({...a,[l]:r})},b=e=>{c({...a,image:e.target.files[0]})},j=()=>{let e={};return a.name||(e.username="Username is required."),a.email?/\S+@\S+\.\S+/.test(a.email)||(e.email="Email is not valid."):e.email="Email is required.",(!a.password||a.password.length<6)&&(e.password="Password must be at least 6 characters long."),a.occupation||(e.occupation="Occupation is required."),v(e),Object.keys(e).length===0},y=async e=>{if(e.preventDefault(),j()){const l=new FormData;for(const r in a)l.append(r,a[r]);try{o(!0);const r=await S.post(`https://portfolio-node-six.vercel.app${f.userRegister}`,l);r&&(o(!1),x(!0),d(r.data.message,"success"))}catch(r){d(r.response.data.message,"error")}finally{o(!1)}}};return i==="verified"?s.jsx(F,{to:"/blogs"}):s.jsxs(s.Fragment,{children:[s.jsxs(O,{sx:{width:{xs:"100%",sm:"500px"},margin:"auto",padding:{xs:2,sm:3},boxShadow:3,borderRadius:2,backgroundColor:"background.paper",my:5},children:[s.jsx(w,{id:"register-box-title",variant:"h6",component:"h2",align:"center",children:"Register"}),s.jsxs(O,{component:"form",onSubmit:y,noValidate:!0,sx:{mt:2},className:`\r
        flex flex-col gap-2`,children:[s.jsx(m,{fullWidth:!0,label:"Name",name:"name",value:a.username,onChange:u,error:!!t.username,helperText:t.username}),s.jsx(m,{fullWidth:!0,label:"Email",name:"email",type:"email",value:a.email,onChange:u,error:!!t.email,helperText:t.email}),s.jsx(m,{fullWidth:!0,label:"Password",name:"password",type:"password",value:a.password,onChange:u,error:!!t.password,helperText:t.password}),s.jsx(m,{fullWidth:!0,label:"Occupation",name:"occupation",value:a.occupation,error:!!t.occupation,helperText:t.occupation,onChange:u}),s.jsx("span",{children:"Profile Photo:"}),s.jsx("input",{type:"file",name:"image",onChange:b,accept:"image/*"}),s.jsx(C,{type:"submit",fullWidth:!0,variant:"contained",className:"button",sx:{mt:3,mb:2},children:p?s.jsx("div",{className:"h-8 w-8 animate-spin  rounded-full border-4 border-e-transparent motion-reduce:animate-[spin_1.5s_linear_infinite]"}):"Register"})]}),s.jsxs(w,{component:"div",align:"center",children:["Already have an account?"," ",s.jsx("div",{className:"cursor-pointer text-sky-500",onClick:()=>h("/blogs/login"),children:"Login"})]})]}),s.jsx(I,{visible:g,email:a.email})]})};export{W as default};
